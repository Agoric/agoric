#! /usr/bin/env node
import { basename } from 'path';
import process from 'process';
import Arborist from '@npmcli/arborist';

const arb = new Arborist({ path: '../..' });
// root-level
const tree = await arb.loadActual();

// query all production dependencies
const results = await tree.querySelectorAll('.workspace');
const packageNames = new Set(results.map(node => node.packageName));

const nameList = Array.from(packageNames).sort();

// Write the module.
process.stdout.write(`\
// DO NOT EDIT - automatically generated by ${basename(
  new URL(import.meta.url).pathname,
)}
// prettier-ignore
export default ${JSON.stringify(nameList, null, 2)};
`);
